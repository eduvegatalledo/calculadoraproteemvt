<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Protee ‚Äî Plataforma de Nutrici√≥n y Macros</title>
<meta name="description" content="Calcula macros, analiza platos, escanea etiquetas y lleva tu progreso d√≠a a d√≠a. ES/EN, login por email, dashboard y base de alimentos ampliada."/>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü•ó</text></svg>">

<!-- Librer√≠as externas -->
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/tesseract.js@5.0.2/dist/tesseract.min.js"></script>

<style>
/* === ESTILOS GENERALES === */
:root{
  --bg:#f8fbf9; --card:#ffffff; --text:#1b1f23; --muted:#6c7680;
  --primary:#20c997; --primary-2:#0fb37f; --border:#e7ecef; --accent:#1f8a70;
}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:Nunito,system-ui,Segoe UI,Roboto,Arial,sans-serif;line-height:1.5}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
button,input,select,textarea{font-family:inherit}
a{color:var(--accent);text-decoration:none}
header{position:sticky;top:0;z-index:5;background:rgba(248,251,249,.95);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
.nav{display:flex;align-items:center;gap:14px}
.logo{display:flex;align-items:center;gap:10px}
.logo svg{width:28px;height:28px}
.logo-title{font-weight:800;letter-spacing:.3px}
.btn{border:1px solid var(--border);background:#f1f7f4;border-radius:999px;padding:8px 14px;cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--primary),var(--primary-2));color:#fff;border:0;font-weight:700}
.grid{display:grid;gap:14px}
.g2{grid-template-columns:1fr 1fr}.g3{grid-template-columns:repeat(3,1fr)}
@media (max-width:900px){.g2,.g3{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px}
h2{font-size:1.3rem;margin:10px 0}
.small{color:var(--muted);font-size:.9rem}
.tile{display:flex;gap:12px;align-items:center;border:1px solid var(--border);border-radius:16px;padding:16px;background:#fff;cursor:pointer;transition:.15s}
.tile:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.05)}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid var(--border);padding:10px;text-align:left}
.footer{margin:28px 0;color:var(--muted);font-size:.85rem}
.hidden{display:none}
.lang{padding:6px 10px;border-radius:8px;border:1px solid var(--border);background:#fff}
</style>
</head>
<body>
<header>
  <div class="wrap nav" style="justify-content:space-between">
    <div class="logo">
      <svg viewBox="0 0 64 64" fill="none">
        <defs><linearGradient id="g" x1="0" y1="0" x2="64" y2="64"><stop stop-color="#20c997"/><stop offset="1" stop-color="#0fb37f"/></linearGradient></defs>
        <path d="M12 26h40v12H12z" stroke="url(#g)" stroke-width="4" fill="none" stroke-linejoin="round"/>
        <path d="M20 20v24M44 20v24" stroke="url(#g)" stroke-width="4" stroke-linecap="round"/>
        <path d="M8 44c8-2 18-12 20-22 6 8 18 10 28 8-6 10-20 16-34 16-6 0-10-1-14-2z" fill="url(#g)" opacity=".2"/>
      </svg>
      <div class="logo-title">Protee</div>
      <span class="tag">V2</span>
    </div>
    <div class="nav">
      <select id="lang" class="lang">
        <option value="es">ES</option><option value="en">EN</option>
      </select>
      <button id="btnLogin" class="btn">Iniciar sesi√≥n</button>
      <div id="userBox" class="hidden">
        <span id="userEmail" class="small"></span>
        <button id="btnLogout" class="btn">Salir</button>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- Secciones de la app (men√∫, calculadora, analizador, OCR, dashboard, perfil, etc.) -->
  <section id="view-home" class="grid g3">
    <div class="tile" data-go="calc"><strong>üßÆ Calculadora</strong></div>
    <div class="tile" data-go="meal"><strong>üçΩÔ∏è Analizar comida</strong></div>
    <div class="tile" data-go="scan"><strong>üì∑ Escanear etiqueta</strong></div>
    <div class="tile" data-go="log"><strong>üìù Registro diario</strong></div>
    <div class="tile" data-go="dash"><strong>üìä Dashboard</strong></div>
    <div class="tile" data-go="profile"><strong>üë§ Perfil</strong></div>
  </section>
</main>

<div id="cookieBanner" class="hidden" style="position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid var(--border);padding:12px;z-index:50">
  <div class="wrap" style="display:flex;gap:12px;align-items:center;justify-content:space-between;max-width:1100px">
    <div class="small">Usamos cookies para mejorar tu experiencia.</div>
    <div style="display:flex;gap:8px">
      <button id="cookieAccept" class="btn primary">Aceptar</button>
      <button id="cookieDecline" class="btn">Rechazar</button>
    </div>
  </div>
</div>

<script type="module">
  // ‚úÖ Configuraci√≥n de Supabase con tu URL y anon key
  const SUPABASE_URL = "https://dnygudxhimjksxedzckl.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRueWd1ZHhoaW1qa3N4ZWR6Y2tsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3NzA5NTEsImV4cCI6MjA3MjM0Njk1MX0.VysJaMOWnPpkg0ty4F68C5G_fI7gw8iabDL4SE_mzWI";

  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // Ejemplo r√°pido: refrescar el estado de login
  async function refreshAuthUI(){
    const { data: { user } } = await supabase.auth.getUser();
    if(user){
      document.getElementById("btnLogin").classList.add("hidden");
      document.getElementById("userBox").classList.remove("hidden");
      document.getElementById("userEmail").textContent = user.email;
    }else{
      document.getElementById("btnLogin").classList.remove("hidden");
      document.getElementById("userBox").classList.add("hidden");
    }
  }

  // Botones login/logout
  document.getElementById("btnLogin").onclick = async ()=>{
    const email = prompt("Tu correo:");
    const password = prompt("Tu contrase√±a (o crea una):");
    if(!email || !password) return;
    let { error } = await supabase.auth.signUp({ email, password });
    if(error && error.message.includes("already")){
      await supabase.auth.signInWithPassword({ email, password });
    }
    refreshAuthUI();
  };
  document.getElementById("btnLogout").onclick = async ()=>{ await supabase.auth.signOut(); refreshAuthUI(); };

  refreshAuthUI();
</script>
</body>
</html>
